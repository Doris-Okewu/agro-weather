(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();const T="demo";console.log("API Key loaded:",T);const p=document.getElementById("city-input"),P=document.getElementById("search-btn"),z=document.getElementById("geo-btn"),L=document.getElementById("city-name"),y=document.getElementById("temperature"),b=document.getElementById("description"),x=document.getElementById("humidity"),I=document.getElementById("wind"),H=document.getElementById("sunrise"),W=document.getElementById("sunset"),h=document.getElementById("tip"),C=document.getElementById("forecast-cards"),k=document.getElementById("theme-toggle"),B=document.getElementById("loading"),u=document.getElementById("error"),m=document.querySelector(".current-weather"),M=document.querySelector(".agri-tips"),S=document.querySelector(".forecast"),N=document.getElementById("weather-icon"),d=document.getElementById("crop"),$=document.getElementById("add-crop-btn"),r=document.getElementById("new-crop-input"),G={maize:{hot:["In this Abuja heat (over 30°C), water your maize early morning to keep roots cool — like the pros in Kaduna do.","Too much sun? Mulch around your maize to protect the soil — helps keep yields high even in dry harmattan."],rain:["Rainy season blessing! Plant maize now (March-June) for bumper harvest — just watch for Striga weeds.","Good rains mean vigorous maize roots; add compost for that extra boost before the dry hits."],windy:["Winds picking up? Stake young maize early to avoid lodging — common fix in northern farms.","Strong gusts? Space maize rows wider for better airflow; keeps ears full and healthy."],dry:"Low humidity? Irrigate maize steadily; don't let it stress like in last year's dry spell."},rice:{hot:["Hot temps frying paddies? Flood fields shallow to cool soil — rice loves it in Niger State's lowlands.","Above 30°C? Shade young rice transplants; boosts tillering without extra cost."],rain:["Perfect rainy weather for rice! Transplant now in well-drained loamy soil (pH 5.5-7.5) for 3-4 month harvest.","Ample rain? Early planting beats floods — Edo farmers swear by it for escape from Gbako disasters."],windy:["Windy rains? Avoid spraying rice now; let it settle to prevent drift on your lowland fields.","Gusts over 8 m/s? Plant rice in blocks, not rows, for natural windbreaks."],dry:"Dry patch? Supplemental irrigation keeps rice yields at 2.5-4 tons/ha — don't skip it."},cassava:{hot:["Cassava handles Nigeria's heat (25-29°C ideal), but mulch thick to keep soil moist in semi-arid spots.","Hot and dry? Deep till for cassava roots; it thrives rainfed but needs that first good soak."],rain:["Rainy start? Plant cassava cuttings now (before July) in aerated soil (pH 5.5-6.5) for rot-free roots.","Wet season vibes: Cassava loves humid warmth; space 1m apart to avoid waterlogging in your plot."],windy:["Winds battering? Choose wind-resistant cassava varieties like TMS98/0505; stake if needed in open fields.","Gusty weather? Plant cassava in ridges for stability — cuts erosion in Nigeria's dissected zones."],dry:"Low rain? Cassava survives drought better than most, but add manure for 8-11 t/ha yields."}};k.addEventListener("click",()=>{document.body.classList.toggle("dark-mode"),k.textContent=document.body.classList.contains("dark-mode")?"Light Mode":"Dark Mode"});p.addEventListener("keypress",e=>{e.key==="Enter"&&w(p.value.trim())});P.addEventListener("click",()=>w(p.value.trim()));z.addEventListener("click",()=>{navigator.geolocation?(D(),navigator.geolocation.getCurrentPosition(e=>fetchWeatherByCoords(e.coords.latitude,e.coords.longitude),()=>f("Location access denied."))):f("Geolocation not supported.")});$.addEventListener("click",()=>{if(r.style.display==="none"||r.style.display==="")r.style.display="inline-block",r.focus();else{const e=r.value.trim().toLowerCase();if(e&&!document.querySelector(`#crop option[value="${e}"]`)){const t=document.createElement("option");t.value=e,t.textContent=e.charAt(0).toUpperCase()+e.slice(1),d.appendChild(t),d.value=e,r.value="",h.textContent=`Added ${t.textContent}! Monitor for pests and water as needed.`}r.style.display="none"}});document.addEventListener("click",e=>{!$.contains(e.target)&&!r.contains(e.target)&&(r.style.display="none")});d.addEventListener("change",()=>{var e,t;if(y.textContent!=="--°C"){const o={main:{temp:parseFloat(y.textContent),humidity:parseInt(((e=x.textContent.match(/\d+/))==null?void 0:e[0])||50)},weather:[{main:b.textContent}],wind:{speed:parseFloat(((t=I.textContent.match(/\d+\.?\d*/))==null?void 0:t[0])||0)}};h.textContent=v(o,d.value)}});async function w(e){if(!e)return f("Please enter a city.");D();{const t={name:e,sys:{country:"NG",sunrise:Math.floor(Date.now()/1e3)-3600,sunset:Math.floor(Date.now()/1e3)+3600},main:{temp:28+Math.random()*5,humidity:65+Math.floor(Math.random()*20)},weather:[{description:"partly cloudy",icon:"02d",main:"Clouds"}],wind:{speed:3.5+Math.random()*3},coord:{lat:6.5244,lon:3.3792}};F(t),O();return}}async function O(e,t){{const o=Array.from({length:40},(s,n)=>({dt:Math.floor(Date.now()/1e3)+n*10800,main:{temp:27+Math.random()*6},weather:[{icon:n%3===0?"01d":n%3===1?"02d":"10d",main:"Clear"}]}));K(q(o)),g(S);return}}function F(e){A(),g(m),g(M),L.textContent=`${e.name}, ${e.sys.country}`,y.textContent=`${Math.round(e.main.temp)}°C`,b.textContent=j(e.weather[0].description),x.textContent=`Humidity: ${e.main.humidity}%`,I.textContent=`Wind: ${e.wind.speed} m/s`,H.textContent=`Sunrise: ${E(e.sys.sunrise)}`,W.textContent=`Sunset: ${E(e.sys.sunset)}`,N.src=`https://openweathermap.org/img/wn/${e.weather[0].icon}@2x.png`,h.textContent=v(e,d.value)}function q(e){const t={};return e.forEach(o=>{const s=new Date(o.dt*1e3).toLocaleDateString();t[s]||(t[s]=[]),t[s].push(o)}),Object.values(t).slice(0,5)}function K(e){C.innerHTML="",e.forEach(t=>{const o=t.find(n=>new Date(n.dt*1e3).getHours()===12)||t[0],s=document.createElement("div");s.innerHTML=`
      <h4>${new Date(o.dt*1e3).toLocaleDateString("en",{weekday:"short",month:"short",day:"numeric"})}</h4>
      <img src="https://openweathermap.org/img/wn/${o.weather[0].icon}.png" width="50">
      <p>${Math.round(o.main.temp)}°C</p>
      <p>${o.weather[0].main}</p>
    `,C.appendChild(s)})}function v(e,t="maize"){const o=e.main.temp,s=e.weather[0].main.toLowerCase(),n=e.wind.speed,i=e.main.humidity,a=G[t]||{},c=l=>Array.isArray(l)?l[Math.floor(Math.random()*l.length)]:l;return o>30?c(a.hot)||`Hot day! Water your ${t} early before 10 AM to beat the heat.`:s.includes("rain")?c(a.rain)||`Rains coming — perfect time to plant or weed your ${t}.`:n>8?c(a.windy)||`Winds up — check that your ${t} plants are staked or sheltered.`:i<40?c(a.dry)||`Dry air? Mulch around your ${t} to keep moisture in.`:`Good day for ${t} — scout for pests and keep soil healthy!`}function j(e){return e.charAt(0).toUpperCase()+e.slice(1)}function E(e){return new Date(e*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function D(){B.classList.remove("hidden"),R(),m.innerHTML=`
    <h2><div class="skeleton" style="width: 60%; height: 28px;"></div></h2>
    <div class="weather-info">
      <div class="temp-icon">
        <div class="skeleton" style="width: 60px; height: 60px; border-radius: 50%;"></div>
        <p><div class="skeleton" style="width: 100px; height: 40px;"></div></p>
      </div>
      <p><div class="skeleton" style="width: 80%;"></div></p>
      <p><div class="skeleton" style="width: 70%;"></div></p>
      <p><div class="skeleton" style="width: 75%;"></div></p>
      <p><div class="skeleton" style="width: 65%;"></div></p>
      <p><div class="skeleton" style="width: 70%;"></div></p>
    </div>
  `,m.classList.remove("hidden")}function A(){B.classList.add("hidden")}function f(e){A(),u.textContent=e,u.classList.remove("hidden"),setTimeout(()=>u.classList.add("hidden"),5e3)}function R(){[m,M,S].forEach(e=>e.classList.add("hidden")),u.classList.add("hidden")}function g(e){e.classList.remove("hidden")}window.addEventListener("load",()=>{h.textContent=v({main:{temp:25,humidity:60},weather:[{main:"Clear"}],wind:{speed:5}},d.value)});setInterval(()=>{const e=L.textContent.split(",")[0];e&&e!=="City Name"&&w(e)},10*60*1e3);
